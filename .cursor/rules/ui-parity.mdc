---
description: Enforce full feature and UI parity across all platforms via the unified app
alwaysApply: true
---

# feature and UI parity rules (HIGHEST PRIORITY RULE)

all platforms (desktop, mobile) share a SINGLE unified codebase in `apps/app/`. the UI is built with React Native + react-native-web, meaning components are written once and render on all platforms. the only allowed differences are platform-specific adapters and responsive layout.

## screen contract (all platforms implement these identically)

| screen | purpose | required elements |
|---|---|---|
| HomeScreen | landing / entry | app title, description text, "show QR code / show code" button, "scan QR code / enter code" button |
| ReceiveScreen | receiver flow | QR code display, session code, local address, 10-second auto-regen countdown, status indicator, approval dialog |
| SendScreen | sender flow | QR scanner (camera), manual code input (6-char), address input, connect button, status indicator |
| ActiveSession | data exchange | message list (sent + received), text input, send button, delivery status, copy button, end session button |

## unified codebase rules

1. **one codebase** — all UI code lives in `apps/app/src/`. there is no separate desktop or mobile UI project
2. **shared components** — every component in `apps/app/src/components/` renders on all platforms via react-native-web
3. **shared screens** — every screen in `apps/app/src/screens/` is used on all platforms
4. **shared hooks** — `useSession` and `useTransport` are the same hooks on all platforms
5. **platform detection** — use `apps/app/src/platform.ts` (`isElectron`, `isMobile`, `isWeb`) for conditional logic
6. **platform adapters** — `useTransport` dynamically selects the correct transport adapter per platform

## backend parity rules

1. **same core** — all platforms import from `@sharego/core`. crypto, session, protocol, and transport logic is shared. never duplicate core logic into platform code
2. **same transport behavior** — platform adapters (electron ws server, rn ws server, web ws client, rn ws client) must implement the same `WebSocketServerAdapter` and `WebSocketClientAdapter` interfaces
3. **same discovery** — all platforms use the shared `discoverReceiver()` from core, injecting platform-specific `DiscoveryAdapter` or IP resolver
4. **same security** — crypto, key exchange, encryption, and validation logic is exclusively in core. platform adapters NEVER touch security primitives
5. **same protocol** — message serialization, validation, and handling is in core. platform adapters only do raw byte transport

## visual parity rules

1. **same theme** — all platforms use the identical `colors` object from `apps/app/src/styles/theme.ts`. never define colors inline
2. **same typography** — font sizes, weights, and line heights are defined once in the shared components
3. **same spacing** — padding, margin, gap, and border-radius values are identical across platforms
4. **same layout** — flexbox direction, alignment, and structure are shared React Native components
5. **same copy** — all user-facing text comes from `core/src/i18n/en.ts`, never hardcoded in app code
6. **same flow** — screen transitions, state-driven UI changes, and user interaction patterns are shared
7. **same config** — timing values come from `core/src/config.ts`. never hardcode timing values in app code

## allowed differences (only these)

1. **responsive layout** — desktop may use `maxWidth` constraints for large screens; mobile uses full-width
2. **platform adapters** — `useTransport` returns different adapter implementations per platform (electron IPC vs native RN vs browser WebSocket)
3. **QR scanning** — mobile uses `react-native-vision-camera`, desktop uses `html5-qrcode` (abstracted in `QRScanner` component)
4. **mDNS discovery** — electron uses `bonjour-service`, mobile uses `react-native-zeroconf` (abstracted via `DiscoveryAdapter` interface)
5. **native wrappers** — `SafeAreaView` (mobile only), window chrome (desktop only)

## hook parity

`useSession` and `useTransport` expose the same API surface on all platforms:
- same state fields: `state`, `sessionId`, `qrPayload`, `localAddress`, `pairingRequest`, `receivedItems`, `sentItems`, `error`
- same methods: `startReceiver()`, `startSender()`, `approve()`, `reject()`, `sendData()`, `endSession()`
- same event handling behavior

## shared design tokens

`apps/app/src/styles/theme.ts` is the single source of truth for colors and design tokens. since there is only one theme file now, parity is automatic.
